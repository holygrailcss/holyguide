---
layout: base-clean.njk
---

{# Importamos home.css únicamente para el token-home. #}
<link rel="stylesheet" href="/assets/css/home.css">

<!-- Token home: 3 columnas, navegación horizontal con botones y GSAP -->
<div class="hg-d-flex hg-flex-column hg-min-h-100vh hg-h-100vh">
  <!-- Botones de navegación: texto girado 90° -->
  <button type="button" class="btn btn-tertiary  hg-home-nav-btn hg-home-nav-btn--prev" id="hg-home-nav-prev" aria-label="Columna anterior" disabled>
    <span class="hg-home-nav-btn__text">xxx new season AW 26</span>
  </button>
  <button type="button" class=" btn btn-tertiary  hg-home-nav-btn hg-home-nav-btn--next" id="hg-home-nav-next" aria-label="Columna siguiente">
    <span class="hg-home-nav-btn__text">women new season AW 26</span>
  </button>

  
  <!-- Wrapper: recorta a una columna visible; arrastrar para cambiar de columna -->
  <div class="hg-home-row-cols-wrap hg-home-drag-wrap" id="hg-home-drag-wrap">
    <div class="hg-home-row-cols" id="hg-home-row-cols" data-active="0">
    <!-- Columna 1 -->
    <section class="hg-home-row-cols__col hg-h-100-percent hg-min-h-0 hg-overflow-y-auto px-24">
      <div class="hg-d-flex hg-flex-column hg-gap-y-24">
        <!-- Wrapper para centrar el box animado en el viewport de la columna -->
        <div class="hg-home-box-animated-wrap">
          <div class="hg-home-box hg-home-box-animated">
            <img src="https://static.massimodutti.net/assets/public/b417/9650/83e44e5da0dc/5cd25799ab75/w-bloque5-1-desktop/w-bloque5-1-desktop.jpg" alt="Columna 1">
          </div>
        </div>

        <div class="hg-home-box">
          <img src="/assets/static/home/foto1.jpg" alt="Columna 1">
        </div>

        <div class="hg-home-box">
          <img src="/assets/static/home/foto1.jpg" alt="Columna 1">
        </div>

        <div class="hg-home-box">
          <img src="/assets/static/home/foto1.jpg" alt="Columna 1">
        </div>

      </div>
      {% include '_paginas/templates-2026/hg-footer.njk' %}
    </section>
    <!-- Columna 2 -->
    <section class="hg-home-row-cols__col hg-h-100-percent hg-min-h-0 hg-overflow-y-auto px-24">
      <div class="hg-d-flex hg-flex-column hg-gap-y-24">
        <div class="hg-home-box">
          <div class="hg-aspect-2-3  hg-h-100-percent">
            <img class="hg-aspect-image" src="/assets/static/home/foto2.jpg" alt="Columna 2">
          </div>
        </div>

        <div class="hg-home-box p-104">
          <img src="/assets/static/home/foto2.jpg" alt="Columna 2">
        </div>

        <div class="hg-home-box p-104">
          <img src="/assets/static/home/foto2.jpg" alt="Columna 2">
        </div>

        <div class="hg-home-box">
          <img src="/assets/static/home/foto2.jpg" alt="Columna 2">
        </div>
      </div>
      <footer class="hg-w-100-percent p-24 hg-text-center" >
        <p class="text-m">Footer – HolyGrail5</p>
      </footer>
    </section>  
    <!-- Columna 3 -->
    <section class="hg-home-row-cols__col hg-h-100-percent hg-min-h-0 hg-overflow-y-auto px-24">
      <div class="hg-d-flex hg-flex-column hg-gap-y-24">  
        <div class="hg-home-box">
          <img src="/assets/static/home/foto3.jpg" alt="Columna 3">
        </div>

      </div>
      <footer class="hg-w-100-percent p-24 hg-text-center" >
     
        <ul>
          <li><p class="btn btn-tertiary text-m ttu">APP MASSIMO DUTTI</p></li>
          <li><a class="btn btn-tertiary text-m ttu" href="#">Ayuda</a></li>
          <li><a class="btn btn-tertiary text-m ttu" href="#">Social</a></li>
          <li><a class="btn btn-tertiary text-m ttu"   href="#">Servicios</a></li>
          <li><a class="btn btn-tertiary text-m ttu"   href="#">Legal</a></li>
          <li><a class="btn btn-tertiary text-m ttu"   href="#">Empresa</a></li>
        </ul>

        <ul>
         
          <li> <a href="">CAMBIAR DE MERCADO</a>  </li>
          <li>  <a href="">ESPAÑA</a>  </li>
         
        </ul>
      </footer>
    </section>
  </div>
  </div>
  <!-- Footer debajo de las columnas -->

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script>
(function() {
  var row = document.getElementById('hg-home-row-cols');
  var btnPrev = document.getElementById('hg-home-nav-prev');
  var btnNext = document.getElementById('hg-home-nav-next');
  if (!row || !btnPrev || !btnNext) return;

  var totalCols = 3;
  var currentIndex = 0;

  function getColWidthPx() {
    return window.innerWidth - 200;
  }

  var cols = row ? row.querySelectorAll('.hg-home-row-cols__col') : [];

  var fadeStartRatio = 0.001;

  function updateBoxOpacity(col) {
    if (!col) return;
    var colRect = col.getBoundingClientRect();
    var colHeight = colRect.height;
    var fadeStartPx = fadeStartRatio * colHeight;
    var boxes = col.querySelectorAll('.hg-home-box');
    boxes.forEach(function(box) {
      var boxRect = box.getBoundingClientRect();
      var boxTop = boxRect.top - colRect.top;
      var boxHeight = boxRect.height;
      var opacity = Math.min(1, Math.max(0, (boxTop + boxHeight) / (fadeStartPx + boxHeight)));
      box.style.opacity = String(opacity);
    });
  }

  function setupScrollFade() {
    cols.forEach(function(col) {
      col.addEventListener('scroll', function() { updateBoxOpacity(col); });
      updateBoxOpacity(col);
    });
  }

  function goToIndex(index) {
    if (index < 0 || index >= totalCols) return;
    currentIndex = index;
    row.setAttribute('data-active', String(index));
    var x = -currentIndex * getColWidthPx();
    gsap.to(row, { x: x, duration: 0.5, ease: 'power3.out' });
    cols.forEach(function(col, i) {
      gsap.to(col, { scale: i === currentIndex ? 1 : 0.5, duration: 0.5, ease: 'power3.out' });
    });
    btnPrev.disabled = currentIndex === 0;
    btnNext.disabled = currentIndex === totalCols - 1;
  }

  btnPrev.addEventListener('click', function() {
    if (currentIndex > 0) goToIndex(currentIndex - 1);
  });
  btnNext.addEventListener('click', function() {
    if (currentIndex < totalCols - 1) goToIndex(currentIndex + 1);
  });

  /* Drag: click + arrastrar mueve las columnas; evitar que el scroll de la columna lo bloquee */
  (function() {
    var wrap = document.getElementById('hg-home-drag-wrap');
    if (!wrap) return;
    var startX = 0, startY = 0, baseX = 0, minX = 0, lastX = 0, dragging = false, didDrag = false, captureId = null;
    var SWIPE = 70;

    function getX(e, isEnd) {
      if (e.touches && e.touches.length) return e.touches[0].clientX;
      if (e.changedTouches && e.changedTouches.length) return e.changedTouches[0].clientX;
      return e.clientX;
    }
    function getY(e, isEnd) {
      if (e.touches && e.touches.length) return e.touches[0].clientY;
      if (e.changedTouches && e.changedTouches.length) return e.changedTouches[0].clientY;
      return e.clientY;
    }

    function start(e) {
      if (dragging) return;
      if (e.button !== 0 && e.type === 'pointerdown') return;
      dragging = true;
      didDrag = false;
      startX = getX(e, false);
      startY = getY(e, false);
      baseX = -currentIndex * getColWidthPx();
      lastX = baseX;
      minX = -(totalCols - 1) * getColWidthPx();
      gsap.killTweensOf(row);
      captureId = e.pointerId != null ? e.pointerId : null;
      if (captureId != null) wrap.setPointerCapture(captureId);
      if (!e.touches) e.preventDefault();
    }

    function move(e) {
      if (!dragging) return;
      var x = getX(e, false);
      var y = getY(e, false);
      var dx = x - startX;
      var dy = y - startY;
      if (!didDrag) {
        if (Math.abs(dx) > 8 || Math.abs(dy) > 8) {
          didDrag = Math.abs(dx) >= Math.abs(dy);
          if (!didDrag) { dragging = false; return; }
        }
      }
      lastX = Math.max(minX, Math.min(0, baseX + dx));
      row.style.transform = 'translate3d(' + lastX + 'px, 0, 0)';
      e.preventDefault();
    }

    function end(e) {
      var x = getX(e, true);
      var dx = x - startX;
      try { if (captureId != null) wrap.releasePointerCapture(captureId); } catch (_) {}
      captureId = null;
      if (!dragging) return;
      dragging = false;
      gsap.set(row, { x: lastX });
      if (didDrag) {
        if (dx > SWIPE && currentIndex > 0) goToIndex(currentIndex - 1);
        else if (dx < -SWIPE && currentIndex < totalCols - 1) goToIndex(currentIndex + 1);
        else goToIndex(currentIndex);
      } else {
        goToIndex(currentIndex);
      }
    }

    function cancel(e) {
      try { if (captureId != null) wrap.releasePointerCapture(captureId); } catch (_) {}
      captureId = null;
      if (!dragging) return;
      dragging = false;
      gsap.set(row, { x: -currentIndex * getColWidthPx() });
      goToIndex(currentIndex);
    }

    wrap.addEventListener('pointerdown', start, { passive: false });
    wrap.addEventListener('touchstart', start, { passive: true });
    wrap.addEventListener('pointermove', move, { passive: false });
    wrap.addEventListener('touchmove', move, { passive: false });
    wrap.addEventListener('pointerup', end, { passive: true });
    wrap.addEventListener('pointercancel', cancel, { passive: true });
    wrap.addEventListener('touchend', end, { passive: true });
    wrap.addEventListener('touchcancel', cancel, { passive: true });
  })();

  window.addEventListener('resize', function() {
    goToIndex(currentIndex);
    cols.forEach(function(col) { updateBoxOpacity(col); });
  });

  /* Estado inicial: columna 1 al 100%, resto al 50% */
  cols.forEach(function(col, i) {
    gsap.set(col, { scale: i === 0 ? 1 : 0.5 });
  });
  goToIndex(0);
  setupScrollFade();

  /* Tras 1 s: animar .hg-home-box-animated de 1:1 (50vh) a 3:2 (100vh alto) */
  setTimeout(function() {
    var animatedBoxes = document.querySelectorAll('.hg-home-box-animated');
    animatedBoxes.forEach(function(el) {
      gsap.to(el, {
        height: '100vh',
        width: '150vh',
        duration: 1.2,
        ease: 'power2.out'
      });
    });
  }, 1000);
})();
</script>
