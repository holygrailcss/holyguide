---
layout: base-clean.njk
---

{# Importamos home.css únicamente para el token-home. #}
<link rel="stylesheet" href="/assets/css/home.css">


{% include '_paginas/templates-2026/hg-header.njk' %}

<!-- Panel hg-menu: se abre al hacer click en .menu-item-header -->
<div id="hg-menu-panel" class="hg-menu-panel" aria-hidden="true">
  <button type="button" class="hg-menu-panel__close" aria-label="Cerrar menú">&times;</button>

    {% include '_paginas/templates-2026/hg-menu.njk' %}

</div>
<div id="hg-menu-backdrop" class="hg-menu-backdrop" aria-hidden="true"></div>

<!-- Token home: 3 columnas, navegación horizontal con botones y GSAP -->
<div class="hg-home-container hg-d-flex hg-flex-column hg-min-h-100vh hg-h-100vh">
  <!-- Botones de navegación: texto girado 90° -->
  <button type="button" class="btn btn-tertiary  hg-home-nav-btn hg-home-nav-btn--prev" id="hg-home-nav-prev" aria-label="Columna anterior" disabled>
    <span class="hg-home-nav-btn__text">xxx new season AW 26</span>
  </button>
  <button type="button" class=" btn btn-tertiary  hg-home-nav-btn hg-home-nav-btn--next" id="hg-home-nav-next" aria-label="Columna siguiente">
    <span class="hg-home-nav-btn__text">women new season AW 26</span>
  </button>

  
  <!-- Wrapper: recorta a una columna visible; arrastrar para cambiar de columna -->
  <div class="hg-home-row-cols-wrap hg-home-drag-wrap" id="hg-home-drag-wrap">
    <div class="hg-home-row-cols" id="hg-home-row-cols" data-active="0">
    <!-- Columna 1 -->
    <section class="hg-home-row-cols__col hg-h-100-percent hg-min-h-0 hg-overflow-y-auto px-24">
      <div class="hg-d-flex hg-flex-column hg-gap-y-24">
        <!-- Wrapper para centrar el box animado en el viewport de la columna -->
        <div class="hg-home-box-animated-wrap">
          <div class="hg-home-box hg-home-box-animated">
            <img src="https://static.massimodutti.net/assets/public/b417/9650/83e44e5da0dc/5cd25799ab75/w-bloque5-1-desktop/w-bloque5-1-desktop.jpg" alt="Columna 1">
          </div>
        </div>

        <div class="hg-home-box">
          <img src="/assets/static/home/foto1.jpg" alt="Columna 1">
        </div>

        <div class="hg-home-box">
          <img src="/assets/static/home/foto1.jpg" alt="Columna 1">
        </div>

        <div class="hg-home-box">
          <img src="/assets/static/home/foto1.jpg" alt="Columna 1">
        </div>

      </div>
      {% include '_paginas/templates-2026/hg-footer.njk' %}
    </section>
    <!-- Columna 2 -->
    <section class="hg-home-row-cols__col hg-h-100-percent hg-min-h-0 hg-overflow-y-auto px-24">
      <div class="hg-d-flex hg-flex-column hg-gap-y-24">
        <div class="hg-home-box">
          <div class="hg-aspect-2-3  hg-h-100-percent">
            <img class="hg-aspect-image" src="/assets/static/home/foto2.jpg" alt="Columna 2">
          </div>
        </div>

        <div class="hg-home-box p-104">
          <img src="/assets/static/home/foto2.jpg" alt="Columna 2">
        </div>

        <div class="hg-home-box p-104">
          <img src="/assets/static/home/foto2.jpg" alt="Columna 2">
        </div>

        <div class="hg-home-box">
          <img src="/assets/static/home/foto2.jpg" alt="Columna 2">
        </div>
      </div>
      {% include '_paginas/templates-2026/hg-footer.njk' %}
    </section>  
    <!-- Columna 3 -->
    <section class="hg-home-row-cols__col hg-h-100-percent hg-min-h-0 hg-overflow-y-auto px-24">
      <div class="hg-d-flex hg-flex-column hg-gap-y-24">  
        <div class="hg-home-box">
          <img src="/assets/static/home/foto3.jpg" alt="Columna 3">
        </div>

      </div>

      {% include '_paginas/templates-2026/hg-footer.njk' %}
    </section>
  </div>
  </div>
  <!-- Footer debajo de las columnas -->

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script>
(() => {
  // -----------------------------
  // 1) Referencias DOM y estado
  // -----------------------------
  const row     = document.getElementById('hg-home-row-cols');
  const prevBtn = document.getElementById('hg-home-nav-prev');
  const nextBtn = document.getElementById('hg-home-nav-next');
  const dragWrap = document.getElementById('hg-home-drag-wrap');

  if (!row || !prevBtn || !nextBtn) return;

  const totalCols = 3;            // número de columnas/páginas
  let active = 0;                 // índice activo (0..totalCols-1)
  const cols = [...row.querySelectorAll('.hg-home-row-cols__col')];

  // ancho "efectivo" de cada columna (tu lógica original)
  const colWidth = () => window.innerWidth - 200;

  // -----------------------------
  // 2) Navegación / animación
  // -----------------------------
  function setActive(index) {
    if (index < 0 || index >= totalCols) return;
    active = index;

    row.dataset.active = String(active);

    // mover el contenedor horizontalmente
    gsap.to(row, {
      x: -active * colWidth(),
      duration: 0.5,
      ease: 'power3.out'
    });

    // escalar columnas: activa 1, resto 0.5
    cols.forEach((col, i) => {
      gsap.to(col, {
        scale: i === active ? 1 : 0.5,
        duration: 0.5,
        ease: 'power3.out'
      });
    });

    prevBtn.disabled = active === 0;
    nextBtn.disabled = active === totalCols - 1;
  }

  prevBtn.addEventListener('click', () => setActive(active - 1));
  nextBtn.addEventListener('click', () => setActive(active + 1));

  // -----------------------------
  // 3) Fade de boxes al hacer scroll dentro de cada columna
  //    (aparece progresivo al entrar por abajo)
  // -----------------------------
  const fadeStartRatio = 0.001;

  function updateBoxOpacity(col) {
    const colRect = col.getBoundingClientRect();
    const fadeStartPx = colRect.height * fadeStartRatio;

    col.querySelectorAll('.hg-home-box').forEach(box => {
      const boxRect = box.getBoundingClientRect();
      const boxTopInsideCol = boxRect.top - colRect.top;
      const boxHeight = boxRect.height;

      // misma fórmula que tenías, pero con nombres más claros
      const opacity = Math.min(1, Math.max(0,
        (boxTopInsideCol + boxHeight) / (fadeStartPx + boxHeight)
      ));

      box.style.opacity = String(opacity);
    });
  }

  function initScrollFade() {
    cols.forEach(col => {
      col.addEventListener('scroll', () => updateBoxOpacity(col));
      updateBoxOpacity(col);
    });
  }

  // -----------------------------
  // 4) Drag / Swipe horizontal (pointer events)
  //    - si el gesto es más horizontal que vertical, cambia de columna
  // -----------------------------
  function initDrag() {
    if (!dragWrap) return;

    const SWIPE_PX = 70;
    const DRAG_START_PX = 8;

    let isDragging = false;
    let started = false;          // ya decidimos si es drag horizontal
    let startX = 0, startY = 0;
    let baseX = 0;                // x inicial del row al empezar a arrastrar
    let lastX = 0;                // último x aplicado
    let pointerId = null;

    const minX = () => -(totalCols - 1) * colWidth();

    function onDown(e) {
      if (e.type === 'pointerdown' && e.button !== 0) return;

      isDragging = true;
      started = false;

      startX = e.clientX;
      startY = e.clientY;

      baseX = -active * colWidth();
      lastX = baseX;

      gsap.killTweensOf(row);

      pointerId = e.pointerId ?? null;
      if (pointerId != null) dragWrap.setPointerCapture(pointerId);

      e.preventDefault();
    }

    function onMove(e) {
      if (!isDragging) return;

      const dx = e.clientX - startX;
      const dy = e.clientY - startY;

      // decidir si el gesto es realmente horizontal
      if (!started) {
        if (Math.abs(dx) > DRAG_START_PX || Math.abs(dy) > DRAG_START_PX) {
          started = Math.abs(dx) >= Math.abs(dy);
          if (!started) { isDragging = false; return; } // era scroll vertical
        } else {
          return;
        }
      }

      lastX = Math.max(minX(), Math.min(0, baseX + dx));
      row.style.transform = `translate3d(${lastX}px,0,0)`;

      e.preventDefault();
    }

    function finish(e) {
      if (pointerId != null) {
        try { dragWrap.releasePointerCapture(pointerId); } catch (_) {}
      }
      pointerId = null;

      if (!isDragging) return;
      isDragging = false;

      // “consolidamos” el transform manual a GSAP x
      gsap.set(row, { x: lastX });

      const dx = e.clientX - startX;

      // si fue swipe suficiente, cambia de columna
      if (started) {
        if (dx > SWIPE_PX) return setActive(active - 1);
        if (dx < -SWIPE_PX) return setActive(active + 1);
      }

      // si no, vuelve a la actual (snap)
      setActive(active);
    }

    function cancel() {
      if (pointerId != null) {
        try { dragWrap.releasePointerCapture(pointerId); } catch (_) {}
      }
      pointerId = null;

      if (!isDragging) return;
      isDragging = false;

      gsap.set(row, { x: -active * colWidth() });
      setActive(active);
    }

    dragWrap.addEventListener('pointerdown', onDown, { passive: false });
    dragWrap.addEventListener('pointermove', onMove, { passive: false });
    dragWrap.addEventListener('pointerup', finish, { passive: true });
    dragWrap.addEventListener('pointercancel', cancel, { passive: true });
  }

  // -----------------------------
  // 5) Resize: recalcular x y opacidades
  // -----------------------------
  window.addEventListener('resize', () => {
    setActive(active);
    cols.forEach(updateBoxOpacity);
  });

  // -----------------------------
  // 6) Init
  // -----------------------------
  // estado inicial: col 0 a 1, resto a 0.5
  cols.forEach((col, i) => gsap.set(col, { scale: i === 0 ? 1 : 0.5 }));
  setActive(0);
  initScrollFade();
  initDrag();

  // -----------------------------
  // 7) Animación “hero” al segundo
  // -----------------------------
  setTimeout(() => {
    document.querySelectorAll('.hg-home-box-animated').forEach(el => {
      gsap.to(el, {
        height: '100vh',
        width: '150vh',
        duration: 1.2,
        ease: 'power2.out'
      });
    });
  }, 1000);

  // Abrir/cerrar hg-menu al hacer click en .menu-item-header
  (function() {
    var panel = document.getElementById('hg-menu-panel');
    var backdrop = document.getElementById('hg-menu-backdrop');
    if (!panel || !backdrop) return;
    function openMenu() {
      panel.classList.add('is-open');
      backdrop.classList.add('is-open');
      panel.setAttribute('aria-hidden', 'false');
      backdrop.setAttribute('aria-hidden', 'false');
    }
    function closeMenu() {
      panel.classList.remove('is-open');
      backdrop.classList.remove('is-open');
      panel.setAttribute('aria-hidden', 'true');
      backdrop.setAttribute('aria-hidden', 'true');
    }
    document.querySelectorAll('.menu-item-header').forEach(function(el) {
      el.addEventListener('click', function(e) {
        e.preventDefault();
        if (panel.classList.contains('is-open')) closeMenu(); else openMenu();
      });
    });
    panel.querySelector('.hg-menu-panel__close').addEventListener('click', closeMenu);
    backdrop.addEventListener('click', closeMenu);
  })();
})();
</script>
